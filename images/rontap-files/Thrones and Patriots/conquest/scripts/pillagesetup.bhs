include "ctw_lib.bhs"

conquest
{

  if (get_ctw_campaign() == "Napoleon") {
    napoleon_rules();
  }


  static int map_size = get_map_size();


  //get nation numbers
  String building_name;
  static int player = 1;
  static int enemy1 = 2;

  int count;

  int step = 1;

  int diff = get_difficulty();

  //enemy1 cities
  static String enemy1_cap_name = find_capital(enemy1);
  static int enemy1_cap_id = find_city_id(enemy1_cap_name);
  static int enemy1_cap_x = object_position_x(enemy1, enemy1_cap_id);
  static int enemy1_cap_y = object_position_y(enemy1, enemy1_cap_id);

  int building;
  String city_name;
  int nation;
  int new_unit;
  int amount;

  //disable these types
  disable_type("Small City");

  //disable these techs from being researched
  disable_tech(enemy1, "Allegiance");

  //set time limit
  set_population_cap(player, 50);
  gain_tech(player, "Military");

  //dont let player get defeated
  disable_city_defeat(player);
  disable_city_defeat(enemy1);

  //unit_costs_disable();

  if (diff == 1) set_time_limit(15);
  //if (diff == 2) set_time_limit(12);
  //if (diff == 3) set_time_limit(10);
  //if (diff == 4) set_time_limit(8);
  //if (diff == 5) set_time_limit(6);
  //if (diff == 6) set_time_limit(5);

  //enemy1 city
  place_building_upgrade(enemy1, "Market", enemy1_cap_name);
  place_building_upgrade(enemy1, "Tower", enemy1_cap_name);
  place_building_upgrade(enemy1, "University", enemy1_cap_name);
  place_building_upgrade(enemy1, "Granary", enemy1_cap_name);
  place_building_upgrade(enemy1, "Farm", enemy1_cap_name);
  place_building_upgrade(enemy1, "Farm", enemy1_cap_name);
  place_building_upgrade(enemy1, "Barracks", enemy1_cap_name);
  place_building_upgrade(enemy1, "Stable", enemy1_cap_name);
  place_building_upgrade(enemy1, "Senate", enemy1_cap_name);
  place_building_upgrade(enemy1, "Temple", enemy1_cap_name);
  create_unit_upgrade(enemy1, enemy1_cap_x, enemy1_cap_y + 2, "Phalanx", 2);
  create_unit_upgrade(enemy1, enemy1_cap_x, enemy1_cap_y + 2, "Archers", diff - 2);
  create_unit_upgrade(enemy1, enemy1_cap_x, enemy1_cap_y + 2, "Javelineers", diff - 2);

  //player 1's army
  force_transport_ability(player);
  int dir = get_conquest_invasion_dir();
  int center = get_map_size() / 2;
  int radius = center - 10;
  int px = (int)(radius * sin(dir) + center);
  int py = (int)(center - (radius * cos(dir)));  

  String campaign = get_ctw_campaign();

  if (campaign == "Alexander the Great") create_unit_upgrade(player, px, py, "Alexander", 1);
  else if (campaign == "Napoleon") create_unit_upgrade(player, px, py, "Napoleon", 1);
  else create_unit_upgrade(player, px, py, "General", 1);
  if (diff < 3) {
    create_unit_in_group(player, px - 4, py, "Phalanx", 1);
    create_unit_in_group(player, px - 4, py, "Javelineers", 1);
    create_unit_in_group(player, px - 3, py, "Archers", 1);
    create_unit_in_group(player, px - 1, py, "Catapult", 1);
  } else if (diff < 5) {
    create_unit_in_group(player, px - 1, py, "Catapult", 1);
  }
  create_unit_in_group(player, px - 4, py, "Phalanx", 4);
  create_unit_in_group(player, px - 4, py, "Javelineers", 3);
  create_unit_in_group(player, px - 3, py, "Archers", 3);
  create_unit_in_group(player, px - 5, py, "Companion", 3);
  create_unit_in_group(player, px - 6, py, "Light Horse", 3);
  create_unit_in_group(player, px - 2, py, "Supply Wagon", 2);
  create_unit_in_group(player, px - 1, py, "Catapult", 2);
  create_unit_in_group(player, px, py, "Scout", 2);

  //get the proper angle
  dir = get_conquest_invasion_dir();
  dir = dir + 180;
  if (dir >= 360) {
    dir = dir - 360;
  }

  group_jump_move(player, px, py, dir);

  int x;
  int y;
  int times = 12;
  
  //for (n = num_military_buildings(enemy1); n > 0; n--) {
   // building = find_military_build(enemy1);
   // set_seen(player, enemy1, building);
  //}

  //set_good(player, "Food", 0);
  //set_good(player, "Timber", 0);
  //set_good(player, "Wealth", 0);
  //set_good(player, "Metal", 0);
  //set_good(player, "Knowledge", 0);

  set_plunder_scale(player, 5);



}